# 语言基础

从C语言转JavaScript，大部分都能当成C来写。没什么问题的。这部分主要讲它与C语言不同的重要部分。

## 语法基础

JavaScript解释器会自动在它觉得加分号的地方加上分号。但最好还是手动加上，这样看起来比较舒心。而且加分号也有助于在某些情况下提升性能，因为解析器会尝试在合适的位置补上分号以纠正语法错误。

### 严格模式

ECMAScript 5 增加了严格模式（strict mode）的概念。只需要在脚本开头加上这一行。ECMAScript 3 的一些不规范写法在这种模式下会被处理，对于不安全的活动将抛出错误。

```js
"use strict"; 

// 下面是单独指定一个函数为严格模式
function doSomething() {
    "use strict";
    // 函数体
} 
```

## 变量

### var关键字

这是一个非常大的坑。

它可替代C语言中的变量类型，随便你怎么写。如果声明了一个变量却没有赋值，那么变量会保存一个特殊值 `undefined`。

```js
var meessage = "h1";
message = 100;
```

1. `var`声明作用域 

使用 `var` 操作符定义的变量会成为包含它的函数的局部变量，意味着该变量将在函数退出时被销毁。

```js
function test() {
    var message = "hi"; // 局部变量
}
test();
console.log(message); // 出错！
```

不过在函数内定义变量时省略 `var` 操作符，可以创建一个全局变量。只要调用一次函数 `test()`，就会定义这个变量，并且可以在函数外部访问到。

```js
function test() {
    message = "hi"; // 全局变量
}
test();
console.log(message); // "hi"
```

2. `var`变量提升

这是这个关键字最恶心的特性。使用这个关键字声明的变量会自动提升到当前作用域顶部。

```js
function foo() {
    console.log(age);
    var age = 26;
}
foo(); // undefined
```

上面这段代码在 ECMAScript 运行时把它看成了这样。

```js
function foo() {
    var age;
    console.log(age);
    age = 26;
}
foo(); // undefined
```

### `let`声明

`let`就比`var`正常多了，符合所有各大语言的习惯。

```js
let age = 30;
console.log(age);     // 30

if (true) { 
    let age = 26;
    console.log(age); // 26
}
```

1. 暂时性死区

```js
// age 不会被提升
console.log(age); // ReferenceError：age 没有定义
let age = 26; 
```

2. 全局声明

与 `var` 关键字不同，使用 `let` 在全局作用域中声明的变量不会成为 `window` 对象的属性（`var` 声明的变量则会）。不过，let 声明仍然是在全局作用域中发生的，为了避免 `SyntaxError`，必须确保页面不会重复声明同一个变量。

```js
var name = 'Matt';
console.log(window.name); // 'Matt'

let age = 26;
console.log(window.age); // undefined
```

3. `for` 循环中的 `let` 声明

在 `let` 出现之前，`for` 循环定义的迭代变量会渗透到循环体外部。

```js
for (var i = 0; i < 5; ++i) {
    // 循环逻辑
}
console.log(i); // 5

// -----

for (var i = 0; i < 5; ++i) {
    setTimeout(() => console.log(i), 0)
}
// 你可能以为会输出 0、1、2、3、4
// 实际上会输出 5、5、5、5、5
```

改成使用 `let` 之后，JavaScript就显得正常多了。

```js
for (let i = 0; i < 5; ++i) {
    // 循环逻辑
}
console.log(i); // ReferenceError: i 没有定义

// -----

for (let i = 0; i < 5; ++i) {
    setTimeout(() => console.log(i), 0)
}
// 会输出 0、1、2、3、4
```

### `const`声明

`const` 的行为与 `let` 基本相同，唯一一个重要的区别是用它声明变量时必须同时初始化变量，且尝试修改 `const` 声明的变量会导致运行时错误。

```js
const age = 26;
age = 36; // TypeError: 给常量赋值
```

所以把它当成不可变的常量就好。

## 数据类型

